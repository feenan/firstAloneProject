<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CNode:Node.js专业中文社区</title>
    <link rel="icon" href="../src/image/icon.png" />
    <link rel="stylesheet" href="../src/css/nav.css" />
    <link rel="stylesheet" href="../src/css/main.css" />
    <link rel="stylesheet" href="../src/css/aside.css" />
    <link rel="stylesheet" href="../src/css/footer.css" />
  </head>
  <body>
    <!-- 头部导航栏 -->
    <header>
      <div class="nav">
        <div id="nav-wrapper">
          <div class="nav-rightContent">
            <a href="#"><img src="../src/image/logo.svg" alt="" /></a>
            <div class="nav-search">
              <span class="iconfont">&#xe618;</span><input type="text" />
            </div>
          </div>
          <div class="nav-leftContent">
            <ul>
              <li>
                <a href="http://127.0.0.1:5500/public/shouye.html">首页</a>
              </li>
              <li>
                <a href="./xinshou.html">新手入门</a>
              </li>
              <li><a href="http://127.0.0.1:5500/public/API.html">API</a></li>
              <li>
                <a href="http://127.0.0.1:5500/public/guanyu.html">关于</a>
              </li>
              <li>
                <a
                  href="https://github.com/login/oauth/authorize?response_type=code&redirect_uri=https%3A%2F%2Fcnodejs.org%2Fauth%2Fgithub%2Fcallback&client_id=0625d398dd9166a196e9"
                  >注册</a
                >
              </li>
              <li>
                <a href="http://127.0.0.1:5500/public/denglu.html">登录</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </header>
    <article>
      <!-- 左侧帖子主区域 -->
      <section>
        <div id="main" class="tiezi">
          <div class="main-nav">
            <div class="main-xinshounav"><a href="./shouye.html">主页</a>/</div>
          </div>
          <div id="main-userMessage">
            <div class="author-message">
              <a href="./user.html"
                ><img
                  src="../src/image/main-content-img_02.jpg"
                  alt=""
                />i5ting</a
              >
              <div class="range-score">745 积分</div>
              <div class="author-collect">
                <a href="./shoucangdehuati.html?tab=collect">19个话题收藏</a>
              </div>
              <div class="author-allMessage">
                <ul>
                  <li>
                    <span class="iconfont">&#xe625;</span
                    ><a href="http://i5ting.com">http://i5ting.com</a>
                  </li>
                  <li><span class="iconfont">&#xe645;</span>北京</li>
                  <li>
                    <span class="iconfont">&#xe604;</span
                    ><a href="https://cnodejs.org/user/i5ting">@it5ing</a>
                  </li>
                  <li><span class="iconfont">&#xe603;</span>shit微博</li>
                </ul>
                <span>注册时间6年前</span>
              </div>
            </div>
          </div>
          <div class="ignore create">
            <div class="header">最近创建的话题</div>
            <div class="create-content">
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
            </div>
            <a href="./shoucangdehuati.html?tab=create" class="lastA"
              >查看更多>></a
            >
          </div>
          <div class="ignore extend">
            <div class="header">最近参与的话题</div>
            <div class="extend-content">
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
              <div class="main-content">
                <!-- http://127.0.0.1:5500/public/tiezi.html -->

                <div class="main-left">
                  <a href="http://127.0.0.1:5500/public/user.html"
                    ><img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-img"
                  /></a>
                  <div class="main-text">
                    <div class="main-text-left">
                      <span class="comment">44</span>/<span class="view"
                        >1820</span
                      >
                    </div>
                    <div class="main-text-right">
                      <a
                        href="http://127.0.0.1:5500/public/tiezi.html"
                        title="请大家遵纪守法，勿发布不合规内容"
                        >请大家遵纪守法，勿发布不合规内容</a
                      >
                    </div>
                  </div>
                </div>
                <div class="main-right">
                  <a href="http://127.0.0.1:5500/public/tiezi.html">
                    <img
                      src="../src/image/main-content-img_01.jpg"
                      alt=""
                      class="user-imgSmall"
                    /><span class="time">1小时前</span>
                  </a>
                </div>
              </div>
            </div>
            <a href="./shoucangdehuati.html?tab=extend" class="lastA"
              >查看更多>></a
            >
          </div>
        </div>

        <!-- 右侧侧边栏 -->
        <aside>
          <div class="author">
            <div class="header">作者</div>
            <div class="author-inner">
              <div class="author-message userHTML">
                <a href="http://127.0.0.1:5500/public/user.html"
                  ><img
                    src="../src/image/main-content-img_02.jpg"
                    alt=""
                  />i5ting</a
                >
              </div>
              <div class="range-score userHTML-score">积分：2</div>
              <em>"这家伙很懒，什么个性签名都没有留下。 "</em>
            </div>
          </div>
          <div class="ignore special-aside">
            <div class="header">作者其他话题</div>
            <div class="ignore-inner author-topics">
              <a href="./tiezi.html">Pagic 官网来啦！ Deno + React 驱动的静</a>
              <a href="./tiezi.html"
                >分享我用 Deno 写的静态网站生成器 - Pagic</a
              >
              <a href="./tiezi.html"
                >分享一个基于puppeteer的高性能spa(vue, react等)SEO解决方案</a
              >
              <a href="./tiezi.html">谈谈 TypeScript 中的类型断言</a>
              <a href="./tiezi.html"
                >超越 google 成为世界第三，eslint-config-alloy 是如何成功的</a
              >
              <a href="./tiezi.html">我写的第一本书《TypeScript 入门教程》</a>
            </div>
          </div>
          <div class="ignore">
            <div class="header">无人回复的话题</div>
            <div class="ignore-inner">
              <a href="./tiezi.html?dataId=5ff2df1e5393a512755468b4"
                >《javascript高级程序设计》学习笔记 | 6.1.理解对象</a
              >
              <a href="./tiezi.html?dataId=5ff17dff5393a578ff5465a7"
                >2021再看deno（CDN for JavaScript modules的思考）</a
              >
              <a href="./tiezi.html?dataId=5ff13c125393a5e7ff5464fa"
                >react17 - react hooks 重构 huangyi 老师 vue music 项目</a
              >
              <a href="./tiezi.html?dataId=5feecd955393a59c33546316"
                >无远社区版开始完全免费！向时代致敬！</a
              >
              <a href="./tiezi.html?dataId=5feabfcb5393a552ce545d28"
                >Apollo 配置中心 Node.js 客户端</a
              >
            </div>
          </div>
        </aside>
      </section>
    </article>
    <!-- 页面尾部 -->
    <footer>
      <div class="footer-wrapper1">
        <div class="footer-wrapper2">
          <div class="foot-header">
            <a href="https://cnodejs.org/rss">RSS</a>&nbsp;|&nbsp;<a
              href="https://github.com/cnodejs/nodeclub/"
              >源码地址</a
            >
          </div>
          <p>
            CNode 社区为国内最专业的 Node.js 开源技术社区，致力于 Node.js
            的技术研究。
          </p>
          <p>
            服务器搭建在
            <a href="https://www.digitalocean.com/?refcode=eba02656eeb3"
              ><img src="../src/image/footer_01.png" alt=""
            /></a>
            ，存储赞助商为
            <a href="https://www.qiniu.com/?ref=cnode"
              ><img src="../src/image/footer_02.png" alt=""
            /></a>
          </p>
          <p>
            新手搭建 Node.js 服务器，推荐使用无需备案的
            <a
              href="https://www.digitalocean.com/?refcode=eba02656eeb3"
              class="footer"
              >DigitalOcean(https://www.digitalocean.com/)</a
            >
          </p>
        </div>
      </div>
    </footer>
    <!-- 回到顶部 -->
    <div id="goBack">
      <a href="#">回到顶部</a>
    </div>
    <script src="../src/js/goBack.js"></script>
    <script src="../src/js/tool.js"></script>
    <script>
      const urlData = location.search;
      let userMessage = document.getElementById("main-userMessage");
      // 侧边栏
      const asideAuthor = document.querySelector(".userHTML");
      const rangeScore = document.getElementsByClassName("userHTML-score")[0];
      const authorTopic = document.querySelector(".author-topics");
      const createTopic = document.querySelector(".create-content");
      const extendTopic = document.querySelector(".extend-content");
      const lastA = document.getElementsByClassName('lastA');
      const booleanArr = [true,false];
      const tabArr = ['ask','share'];
      authorTopic.innerHTML = "";
      function getDataThen(url) {
        getData("user/" + url).then((resp) => {
          const authorMessage = resp.data;
          console.log(resp.data);
          [].forEach.call(lastA,(item)=>{
             item.href += `&author=${authorMessage.loginname}`;
          })
          const recentTopics = handleArr(dataLimited(authorMessage.recent_topics,6));
          const recentReplies = handleArr(dataLimited(authorMessage.recent_replies,6));
          render(recentTopics, createTopic);
          render(recentReplies, extendTopic);
          getData("topic_collect/" + url).then((resp2) => {
            console.log(resp2.data);
            document.title = `@${authorMessage.loginname}的个人主页`;
            userMessage.innerHTML = `<div class="author-message">
              <a href="./user.html?author=${authorMessage.loginname}"
                ><img
                  src="../src/image/main-content-img_02.jpg"
                  alt=""
                />${authorMessage.loginname}</a
              >
              <div class="range-score">${authorMessage.score}个积分</div>
              <div class="author-collect">
                <a href="./shoucangdehuati.html?tab=collect&author=${authorMessage.loginname}">${
                  resp2.data.length
                }个话题收藏</a>
              </div>
              <div class="author-allMessage">
                <ul>
                  <li>
                    <span class="iconfont">&#xe625;</span
                    ><a href=${authorMessage.avatar_url}>${
              authorMessage.avatar_url
            }</a>
                  </li>
                  <li><span class="iconfont">&#xe645;</span>北京</li>
                  <li>
                    <span class="iconfont">&#xe604;</span
                    ><a href="./user.html?author=${authorMessage.loginname}">@${
              authorMessage.loginname
            }</a>
                  </li>
                  <li><span class="iconfont">&#xe603;</span>shit微博</li>
                </ul>
                <span>注册时间${handleDate(authorMessage.create_at)}前</span>
              </div>
            </div>`;
          });
          //  侧边栏
          asideAuthor.innerHTML = `<a href="./user.html?author=${authorMessage.loginname}"
                  ><img
                    src="../src/image/main-content-img_02.jpg"
                    alt=""
                  />${authorMessage.loginname}</a
                >`;
          rangeScore.innerHTML = `积分：${authorMessage.score}`;
          // 作者其他话题
          dataLimited(authorMessage.recent_topics,6).forEach((item) => {
            authorTopic.innerHTML += `<a href="./tiezi.html?dataId=${item.id}"
                >${item.title}</a
              >`;
          });
        });
      }
      getDataThen(handleUrl(urlData));
    function handleArr(arr){
     return  arr.map((item, index)=>{
             return Object.assign(item,{
                reply_count: parseInt(Math.random()*100),
                visit_count: parseInt(Math.random()*1000),
                good: booleanArr[parseInt(Math.random() + 0.5)],
                tab: tabArr[parseInt(Math.random() + 0.5)],
                top:index < 3 ? true : false
              })
          });
    }
    </script>
  </body>
</html>
